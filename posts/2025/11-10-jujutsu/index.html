<!doctype html>
<html prefix="og: http://ogp.me/ns#">
<head>
    <title>版本控制的「柔術」🥋</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

  <meta property="og:site_name" content="Simply Patrick"/>
  <meta property="og:url" content="https://blog.simplypatrick.com/posts/2025/11-10-jujutsu/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://lh3.googleusercontent.com/-GqbL2_hPq9Y/UC9brHyHa1I/AAAAAAAAEoY/rGGtCNWe3Vw/s800/patrick.jpg"/>

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/bootstrap-toc.css" rel="stylesheet">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  <link href='//fonts.googleapis.com/css?family=Julee' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Just+Me+Again+Down+Here' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>

  <link href="/css/prism.css" rel="stylesheet" />
  <link href="/css/blog.css" rel="stylesheet" >

  <link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" />


  <meta property="og:site_name" content="Simply Patrick"/>
  <meta property="og:url" content="https://blog.simplypatrick.com/posts/2025/11-10-jujutsu/"/>
  <meta property="og:title" content="版本控制的「柔術」🥋"/>
  <meta property="og:type" content="article"/>
  <meta property="og:article:published_time" content="2025-11-10 00:00:00 -0800 PST"/>
  
  <meta property="og:article:tag" content="vcs"/>
  
  <meta property="og:article:author" content="Patrick Tsai"/>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container" id="main">
    <div class="row">
      <header role="banner">
  <div class="row">
    <div class="col-md-9">
      <h1 class="banner-title">
        <a href="/">Simply Patrick</a>
        <small class="banner-subtitle">Hopes can always go up, tears can only come down.</small>
      </h1>
    </div>
    <div class="col-md-3 text-right">
      <ul class="social-links list-inline">
        <li><a href="https://twitter.com/PatrickSimply"><i class="fa fa-twitter"></i></a></li>
        <li><a href="https://www.facebook.com/yinghau76"><i class="fa fa-facebook"></i></a></li>
        <li><a href="https://www.linkedin.com/in/yinghau76"><i class="fa fa-linkedin"></i></a></li>
        <li><a href="https://github.com/p47t"><i class="fa fa-github-alt"></i></a></li>
      </ul>
    </div>
  <div>
</header>

      <nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/posts/">posts</a>
      <a class="navbar-brand" href="/tils/">TILs</a>
    </div>

    
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">categories <b class="caret"></b></a>
          <ul class="dropdown-menu">
          
            <li><a href="/categories/blog">blog <span class="badge">3</span></a></li>
          
            <li><a href="/categories/business">business <span class="badge">26</span></a></li>
          
            <li><a href="/categories/career">career <span class="badge">20</span></a></li>
          
            <li><a href="/categories/development">development <span class="badge">52</span></a></li>
          
            <li><a href="/categories/game">game <span class="badge">3</span></a></li>
          
            <li><a href="/categories/programming">programming <span class="badge">186</span></a></li>
          
            <li><a href="/categories/web">web <span class="badge">10</span></a></li>
          
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">tags <b class="caret"></b></a>
          <ul class="dropdown-menu">
          
            <li><a href="/tags/agile">agile <span class="badge">4</span></a></li>
          
            <li><a href="/tags/android">android <span class="badge">12</span></a></li>
          
            <li><a href="/tags/book">book <span class="badge">25</span></a></li>
          
            <li><a href="/tags/build">build <span class="badge">3</span></a></li>
          
            <li><a href="/tags/c&#43;&#43;">c&#43;&#43; <span class="badge">3</span></a></li>
          
            <li><a href="/tags/cloud">cloud <span class="badge">1</span></a></li>
          
            <li><a href="/tags/crack">crack <span class="badge">2</span></a></li>
          
            <li><a href="/tags/cxx">cxx <span class="badge">5</span></a></li>
          
            <li><a href="/tags/dotnet">dotnet <span class="badge">42</span></a></li>
          
            <li><a href="/tags/embedded">embedded <span class="badge">5</span></a></li>
          
            <li><a href="/tags/engineer">engineer <span class="badge">2</span></a></li>
          
            <li><a href="/tags/font">font <span class="badge">3</span></a></li>
          
            <li><a href="/tags/fuchsia">fuchsia <span class="badge">2</span></a></li>
          
            <li><a href="/tags/game">game <span class="badge">2</span></a></li>
          
            <li><a href="/tags/git">git <span class="badge">4</span></a></li>
          
            <li><a href="/tags/go">go <span class="badge">5</span></a></li>
          
            <li><a href="/tags/google">google <span class="badge">5</span></a></li>
          
            <li><a href="/tags/ios">ios <span class="badge">5</span></a></li>
          
            <li><a href="/tags/java">java <span class="badge">9</span></a></li>
          
            <li><a href="/tags/jupyter">jupyter <span class="badge">1</span></a></li>
          
            <li><a href="/tags/kotlin">kotlin <span class="badge">2</span></a></li>
          
            <li><a href="/tags/kuso">kuso <span class="badge">3</span></a></li>
          
            <li><a href="/tags/management">management <span class="badge">3</span></a></li>
          
            <li><a href="/tags/microsoft">microsoft <span class="badge">14</span></a></li>
          
            <li><a href="/tags/octopress">octopress <span class="badge">3</span></a></li>
          
            <li><a href="/tags/osx">osx <span class="badge">4</span></a></li>
          
            <li><a href="/tags/patterns">patterns <span class="badge">4</span></a></li>
          
            <li><a href="/tags/process">process <span class="badge">2</span></a></li>
          
            <li><a href="/tags/ruby">ruby <span class="badge">15</span></a></li>
          
            <li><a href="/tags/rust">rust <span class="badge">3</span></a></li>
          
            <li><a href="/tags/scala">scala <span class="badge">3</span></a></li>
          
            <li><a href="/tags/startup">startup <span class="badge">3</span></a></li>
          
            <li><a href="/tags/vcs">vcs <span class="badge">2</span></a></li>
          
            <li><a href="/tags/web">web <span class="badge">2</span></a></li>
          
            <li><a href="/tags/webkit">webkit <span class="badge">3</span></a></li>
          
            <li><a href="/tags/windows">windows <span class="badge">5</span></a></li>
          
            <li><a href="/tags/work">work <span class="badge">11</span></a></li>
          
          </ul>
        </li>
      </ul>
      <form class="navbar-form navbar-left" role="search" action="//google.com/search" method="get">
        <div class="form-group">
          <input type="hidden" name="as_sitesearch" value="blog.simplypatrick.com" />
          <input class="form-control" type="text" name="q" results="0" placeholder="search"/>
        </div>
        <button type="submit" class="btn btn-default">submit</button>
      </form>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/pages/about">about</a></li>
      </ul>
    </div>
  </div>
</nav>

    </div>

  <div class="row">
    <div class="col-md-9">
          <div class="row">
      <div class="col-xs-6">
        
        <section id="prev" class="text-left">
          <a class="previous" href="https://blog.simplypatrick.com/posts/2021/01-02-rust-jupyter-notebook/">
            <span class="glyphicon glyphicon-circle-arrow-left"></span>
            建置 Jupyter Notebook 的 Rust 運作環境
          </a>
        </section>
        
      </div>
      <div class="col-xs-6">
        
        <section id="next" class="text-right">

          <a class="next" href="https://blog.simplypatrick.com/posts/2025/11-11-jujutsu/">
            版本控制的個人效率追尋：從 git-revise、git-branchstack 到 Jujutsu
            <span class="glyphicon glyphicon-circle-arrow-right"></span>
          </a>
        </section>
        
      </div>
    </div>
      <h2 class="post-title">版本控制的「柔術」🥋</h2>
      <div class="post-meta">
        <span class="post-date">November 10, 2025</span>
        
        <a href="/categories/programming"><span class="label label-info">programming</span></a>
        
        
        <a href="/tags/vcs"><span class="label label-primary">vcs</span></a>
        
      </div>
      

      <div class="post-content">
        <blockquote>
<p><strong>AI 生成聲明：</strong> 本文初稿由 <strong>Gemini AI 2.5 Flash 模型</strong> 生成, 再由個人手動修改而成。</p></blockquote>
<h1 id="從-git-修訂工具到-jujutsu-的優雅進化">從 Git 修訂工具到 Jujutsu 的優雅進化</h1>
<p>許多資深開發者都對 <strong>Git</strong> 的強大功能愛恨交織。它強大, 但某些操作（特別是修改歷史和管理一系列依賴的變更時）卻異常複雜, 像是 <code>git rebase -i</code> 這樣的指令既是利器, 也常是困擾的源頭。</p>
<p>我們將探討一種更優雅、更直覺的版本控制解決方案：<strong>Jujutsu (jj)</strong>。它並不是要取代 Git, 而是作為一個建立在 Git 基礎上的現代化前端, 帶來革命性的工作流程。</p>
<h2 id="第一階段git-生態系統的修補與嘗試">第一階段：Git 生態系統的修補與嘗試</h2>
<p>在 <strong>Jujutsu</strong> 誕生之前, 許多工具試圖修補 Git 的「歷史修改」痛點。這些嘗試為 <code>jj</code> 的核心設計奠定了基礎。</p>
<h3 id="痛點一修訂歷史的麻煩---git-revise-的出現">痛點一：修訂歷史的麻煩 - <strong>git-revise</strong> 的出現</h3>
<ul>
<li><strong>問題：</strong> 在 Git 中修改一個比較舊的 commit, 你需要用 <code>git rebase -i</code>, 找到那一行, 將 <code>pick</code> 改成 <code>edit</code>, 修改後再 <code>git commit --amend</code>, 最後 <code>git rebase --continue</code>。過程繁瑣且容易出錯。</li>
<li><strong>解決方案的萌芽：</strong> 像 <a href="https://github.com/git-revise/git-revise">git-revise</a> 這樣的工具, 讓修訂一個舊 commit 變得更簡單, 通常只需一個指令, 就能自動處理中斷和繼續的步驟。它證明了「<strong>歷史修訂可以更簡單</strong>」的可能性。</li>
</ul>
<h3 id="痛點二依賴變更的管理---git-branchstack-的概念">痛點二：依賴變更的管理 - <strong>git-branchstack</strong> 的概念</h3>
<ul>
<li><strong>問題：</strong> 當你在一個功能上提交了多個依賴的 commits, 如果底層重構的 commit 需要修改, 後續所有 commits 都需要手動 <code>rebase</code>, 或者面對重複的衝突解決。</li>
<li><strong>解決方案的探索：</strong> <a href="https://github.com/krobelus/git-branchstack">git-branchstack</a> 等工具, 嘗試建立一個「堆疊式分支」的概念, 讓開發者能更清楚地追蹤和操作一系列相互依賴的變更。這突顯了開發者對「<strong>自動化處理變基</strong>」的渴望。</li>
</ul>
<h2 id="第二階段jujutsu-的誕生與核心概念">第二階段：Jujutsu 的誕生與核心概念</h2>
<p><a href="https://jj-vcs.github.io/jj/latest/">Jujutsu</a> 正是吸收了這些工具的經驗和願景, 將其融入一個全新的版本控制系統介面中。它重新定義了幾個核心概念：</p>
<h3 id="核心概念一工作區即提交-working-copy-is-a-commit">核心概念一：工作區即提交 (Working Copy is a Commit)</h3>
<ul>
<li><strong>告別暫存區 (Staging Area)：</strong> 在 <code>jj</code> 中, 你的工作目錄狀態<strong>永遠</strong>是一個提交（commit）。你對檔案的修改會自動被視為對當前工作提交的修改。
<ul>
<li><em>好處：</em> 不再需要 <code>git add</code>, 也沒有 <code>git stash</code> 的概念。</li>
</ul>
</li>
</ul>
<h3 id="核心概念二不變的變更-id-change-id">核心概念二：不變的「變更 ID」 (Change ID)</h3>
<ul>
<li><strong>Git 的問題：</strong> 在 Git 中, 你修改一個舊提交（例如使用 <code>amend</code> 或 <code>rebase</code>）會產生一個全新的 <strong>Commit ID</strong> (SHA-1 hash)。</li>
<li><strong>Jujutsu 的解決：</strong> <code>jj</code> 為每個邏輯變更（Change）分配一個不變的 <strong>Change ID</strong>。當你修訂一個 commit 時, 它的 <strong>Commit ID</strong> 會改變, 但 <strong>Change ID</strong> 保持不變。
<ul>
<li><em>好處：</em> 讓 <code>jj</code> 能夠在底層追蹤變更的演進, 即使歷史被重寫, 邏輯變更仍可追溯。</li>
</ul>
</li>
</ul>
<h3 id="核心概念三自動安全且強大的變基-automatic-rebasing">核心概念三：自動、安全且強大的變基 (Automatic Rebasing)</h3>
<ul>
<li><strong>終結 <code>rebase</code> 的恐懼：</strong> 這是 <code>jj</code> 的殺手鐧。當你修改歷史中的某個提交時, 所有後續依賴於它的提交會<strong>自動且安全地</strong>進行變基。
<ul>
<li><em>例如：</em> 你使用 <code>jj edit &lt;old-commit-id&gt;</code> 修改了一個底層提交, 你後續的 commits 會像「柔術」一般優雅地、自動地移到新修訂的提交之上。</li>
</ul>
</li>
</ul>
<h2 id="第三階段jujutsu-帶來的工作流程變革">第三階段：Jujutsu 帶來的工作流程變革</h2>
<p><code>jj</code> 的指令設計更直覺、更以「變更」為中心, 極大地簡化了日常操作。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">jj 操作</th>
          <th style="text-align: left">傳統 Git 工作流</th>
          <th style="text-align: left">優勢與變革</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong><code>jj undo</code></strong></td>
          <td style="text-align: left">難以實現, 需要 <code>git reflog</code></td>
          <td style="text-align: left"><strong>一鍵撤銷</strong>：所有操作（包括變基、修訂）都是可撤銷的, <strong>提供了無損的工作安全網</strong>。</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong><code>jj squash</code></strong></td>
          <td style="text-align: left"><code>git rebase -i</code> 或 <code>git commit --amend</code></td>
          <td style="text-align: left"><strong>輕鬆合併：</strong> 快速將當前工作區的變更併入父提交。</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong><code>jj split</code></strong></td>
          <td style="text-align: left"><code>git rebase -i</code> + 手動操作</td>
          <td style="text-align: left"><strong>輕鬆拆分：</strong> 在不修改原提交的前提下, 將其部分內容拆分為新提交。</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong><code>jj log</code></strong></td>
          <td style="text-align: left"><code>git log --graph</code></td>
          <td style="text-align: left"><strong>清晰日誌：</strong> 預設輸出更易讀的變更圖, 並顯示 Change ID。</td>
      </tr>
  </tbody>
</table>
<h2 id="結語版本控制的未來已來">結語：版本控制的未來已來</h2>
<p><strong>Jujutsu</strong> 將版本控制的複雜性抽象化, 提供了更直覺、更安全、更符合人腦思考邏輯的操作介面。它將我們從 git-revise 和 git-branchstack 試圖解決的局部痛點中解放出來, 提供了一個更全面、優雅的解決方案。</p>
<p>如果你厭倦了 Git 繁瑣的歷史修改流程, 渴望更流暢、更少出錯的開發體驗, 那麼是時候擁抱這門版本控制的「柔術」了。</p>

      </div>

      <hr>
      <script src="https://utteranc.es/client.js"
        repo="yinghau76/yinghau76.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


    </div>
    <div class="col-md-3">
      <aside class="toc">
        






<nav id="toc" data-toggle="toc">
  
  <ul class="nav">
  </ul>
</nav>

      </aside>
    </div>
  </div>
    </div>

    <div class="row">
    <div class="col-md-12">
      <footer id="footer" class="text-center">
        © Patrick Tsai 2003-2019.
        Proudly powered by <a href="http://gohugo.io/">Hugo</a>.
      </footer>
    </div>
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <script src="/js/bootstrap-toc.min.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73968064-1', 'auto');
  ga('send', 'pageview');

</script>


  <script src="/js/prism.js"></script>

</body>
</html>
